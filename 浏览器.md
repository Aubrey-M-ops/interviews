# 浏览器

## 缓存

强缓存 协商缓存

Cache-control

## 存储

### Cookie、sessionStorage、localStorage

> 共同点：都是保存在浏览器端，并且是同源的（协议、端口、host都相同）

#### cookie

HTTP Cookie（也叫 Web Cookie或浏览器 Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。

- 在过期前一直有效（保留数据，不需要重新登陆，保持登录状态/记录用户所在地区，不用每次重新定位）
- 在浏览器和服务器之间来回传递，始终在同源的HTTP请求中携带
- 存储大小很小（只有4k)
- 可以限制路径
- 所有同源窗口共享



- 会话状态管理（如用户登录状态、购物车、游戏分数或其它需要记录的信息）
- 个性化设置（如用户自定义设置、主题等）
- 浏览器行为跟踪（如跟踪分析用户行为等）

> cookie字段：
>
> name字段为一个cookie的名称。
>
> value字段为一个cookie的值。
>
> domain字段为可以访问此cookie的域名。name字段为一个cookie的名称。
>
> path可以访问cookie的页面路径
>
> secure 字段 设置是否只能通过https来传递此条cookie
>
> http字段 cookie的httponly属性。若此属性为true，则只有在http请求头中会带有此cookie的信息，而不能通过document.cookie来访问此cookie。
>
> Size字段此cookie大小。

`Cookie 编码方式：encodeURI()`

##### cookie如何防范XSS攻击

>  XSS（跨站脚本攻击）:攻击者在返回的HTML中嵌入js脚本

在http头部set-cookie

- httponly-禁止js脚本访问cookie
- secure - 仅在请求为https的时候发送cookie

#### cookie（通行证）和session（客户明细表）的区别

##### 为啥需要？

HTTP协议是无状态的协议。一旦数据交换完毕，客户端与服务器端的连接就会关闭，再次交换数据需要建立新的连接。这就意味着服务器无法从连接上跟踪会话。

- cookie存储session id
- session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能，考虑到减轻服务器性能方面，应当使用cookie。

Cookie和session都可用来存储用户信息，cookie存放于客户端，session存放于服务器端

cookie存放于客户端有可能被窃取，所以**cookie一般用来存放不敏感**的信息，比如用户设置的网站主题.

用**session存储敏感**的信息，比如用户的登陆信息

##### **Session的实现原理：**

1）服务端首先查找对应的cookie的值（sessionid）
2）根据sessionid，从服务器端session存储中获取对应id的session数据，进行返回
3）如果找不到sessionid，服务器端就创建session，生成sessionid对应的cookie，写入到响应头中

##### **如果浏览器中禁止了 Cookie，如何保障整个机制的正常运转？**

第一种方案，每次请求中都携带一个 SessionID 的参数，也可以 Post 的方式提交，也可以在请求的地址后面拼接`xxx?SessionID=123456...`。

第二种方案，Token 机制。当用户第一次登录后，服务器根据提交的用户信息生成一个 Token，响应时将 Token 返回给客户端，以后客户端只需带上这个 Token 前来请求数据即可，无需再次登录验证。



>SessionStorage localStorage 仅在客户端中保存，不参与和服务器的通信

#### SessionStorage

- 浏览器窗口关闭就没了
- 不在不同浏览器窗口共享，即使是同一个页面

#### localStorage

- 浏览器窗口关闭也一直保存，是**永久数据**
- 所有同源窗口共享

 

## SPA

https://www.jianshu.com/p/a02eb15d2d70

## BOM

>  BOM是浏览器对象

- location对象
  - location.href-- 返回或设置当前文档的URL
  - location.search -- 返回URL中的查询字符串部分。
  - location.hash -- 返回URL#后面的内容，如果没有#，返回空
  - location.replace(url);
  - location.reload() -- 重载当前页面
- history对象
  - history.go() -- 前进或后退指定的页面数 history.go(num);
  - history.back() -- 后退一页
  - history.forward() -- 前进一页





